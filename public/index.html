<html>
<head>
<title>API Call</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,100;0,300;0,400;0,700;0,900;1,100;1,300;1,400;1,700;1,900&display=swap" rel="stylesheet">
<script src="https://code.jquery.com/jquery-3.7.1.js" integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4=" crossorigin="anonymous"></script>
<style type="text/css">
    body, html {font-family:"Lato", "sans-serif"}
    
    #logout-btn {
        display: 'none';
    }
</style>
</head>
<body>
    <h1>Starview</h1>
    <nav id="login-nav-bar">
        <a href="/login">Log in</a>
        <a href="/signup">Create an account</a>
    </nav>
    <button id="logout-btn">Logout</button>

    <div id = "text_t"></div>
<script>

        async function hideNav() {
            const navBar = document.getElementById('login-nav-bar');
            const logoutBtn = document.getElementById('logout-btn');
            try {
                const response = await fetch('/session');
                const data = await response.json();

                if (data.loggedIn) {
                    navBar.style.display = 'none';
                    logoutBtn.style.display = 'block';
                }

            } catch (e) {
                console.log(e);
                alert('there is an error' + e); 
            }

        }

        async function get_data() {
        let x = 113.17;
        let y = 23.09;
        let response = await fetch("http://www.7timer.info/bin/api.pl?lon=" + x + "&lat=" + y + "&product=astro&output=json");
        if (response.ok) {
            let json = await response.json();
            let text_t = JSON.stringify(json);
            console.log(text_t);
            let objj = JSON.parse(text_t);
            // put whatever we are going to do with it here
        } else {
            alert("HTTP-Error: " + response.status);
        }
    }
    hideNav();
    //get_data();





</script>
<script src="js/auth.js"></script>
</body>
</html>

