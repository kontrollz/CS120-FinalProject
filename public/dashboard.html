<!-- dashboard.html -->
<!DOCTYPE html>
<html>
  <head>
    <title>Dashboard – StarView</title>
    <link rel="stylesheet" href="/css/styles.css" />
  </head>
  <body>
    <div class="page">
      <div id="header"></div>

      <main>
        <h2 id="greeting"></h2>
        <nav id="login-nav-bar">
            <a href="/signup">Create an account</a>
            <a href="/login">Log in</a>
        </nav>
        <button id="logout-btn">Logout</button>

        <div class="card">
          <p class="page-intro">
            Check astronomy-friendly weather for your observing spots.
          </p>
          <h1>Observation Dashboard</h1>

          <div class="dashboard-grid">
            <section>
              <h2>Location</h2>
              <form id="astro-form">
                <div class="form-row">
                  <label for="lat">Latitude</label>
                  <input
                    type="number"
                    step="0.001"
                    id="lat"
                    name="lat"
                    placeholder="e.g., 42.360"
                    required
                  />
                </div>
                <div class="form-row">
                  <label for="lon">Longitude</label>
                  <input
                    type="number"
                    step="0.001"
                    id="lon"
                    name="lon"
                    placeholder="e.g., -71.060"
                    required
                  />
                </div>

                <button type="submit">Get Forecast</button>
              </form>

              <p id="astro-message" class="message"></p>
            </section>

            <section>
              <h2>What we show</h2>
              <ul class="metric-list">
                <li>
                  <strong>Cloud Cover</strong> – portion of the sky covered by
                  clouds.
                </li>
                <li>
                  <strong>Seeing</strong> – stability of the atmosphere for high
                  magnification views.
                </li>
                <li>
                  <strong>Transparency</strong> – clarity of the sky, important
                  for faint objects.
                </li>
                <li>
                  <strong>Temperature</strong> – air temperature (approximate
                  comfort & equipment impact).
                </li>
              </ul>
            </section>
          </div>
        </div>


      </main>

      <div id="footer"></div>
    </div>

    <!-- <script src="js/loadPartials.js"></script> -->
    <script src="js/auth.js"></script>
    <script>
      const astroForm = document.getElementById("astro-form");
      const msg = document.getElementById("astro-message");
      
      astroForm.addEventListener("submit", (e) => {
        e.preventDefault();
        
        // get form data
        const formData = new FormData(astroForm);
        const data = Object.fromEntries(formData);
        const lat = data.lat;
        const lon = data.lon;

        const invalid = false;
        // need to enforce valid lat/lon
        if (invalid) {
        msg.textContent =
          "Please enter a valid lat/lon!."; // they won't see this unless there's an error with lat/lon
        }

        // get request with lat and lon, john's page will collect query
        window.location.href = `/forecast?lat=${lat}&lon=${lon}`;


      });

      // no matter what, we're passing a lat/lon to john's page
      // we'll use the session to figure out what to display to the user
      // 'Boston', or 'Current Location (lat/lon)', or 'lat/lon'

      // want to accept a city -> this might not be feasible
        // https://api.opencagedata.com/ <-- this should work! need to make an account and get a key

      // want to accept a lat/lon -> no extra logic necessary, just pull from form

      // want to use current location. this is actually really easy
    //       navigator.geolocation.getCurrentPosition(
    //          (position) => {
    //          const { latitude, lonitude } = position.coords;
    //          console.log("Lat:", latitude, "Lon:", lonitude);
    //          },
    //              (error) => {
    //                  console.error("Error getting location:", error);
    //          }
    //       );
      

    </script>
  </body>
</html>
